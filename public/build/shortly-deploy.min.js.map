{"version":3,"sources":["../client/app.js","../client/createLinkView.js","../client/link.js","../client/linkView.js","../client/links.js","../client/linksView.js","../client/router.js"],"names":["window","Shortly","Backbone","View","extend","template","Templates","layout","events","click li a.index","click li a.create","initialize","console","log","$","append","this","render","el","router","Router","$el","find","on","updateNav","history","start","pushState","html","renderIndexView","e","preventDefault","navigate","trigger","renderCreateView","routeName","removeClass","filter","addClass","createLinkView","className","create","submit","shortenUrl","$form","link","Link","url","val","startSpinner","success","failure","save","stopSpinner","view","LinkView","model","hide","fadeIn","res","show","attr","fadeOut","Model","urlRoot","attributes","Links","Collection","LinksView","collection","addAll","fetch","empty","forEach","addOne","item","options","routes","","swapView","index","links","linksView"],"mappings":"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","file":"shortly-deploy.min.js","sourcesContent":["window.Shortly = Backbone.View.extend({\n  template: Templates.layout,\n\n  events: {\n    'click li a.index': 'renderIndexView',\n    'click li a.create': 'renderCreateView'\n  },\n\n  initialize: function() {\n    console.log( 'Shortly is running' );\n    $('body').append(this.render().el);\n\n    this.router = new Shortly.Router({ el: this.$el.find('#container') });\n    this.router.on('route', this.updateNav, this);\n\n    Backbone.history.start({ pushState: true });\n  },\n\n  render: function() {\n    this.$el.html( this.template() );\n    return this;\n  },\n\n  renderIndexView: function(e) {\n    e && e.preventDefault();\n    this.router.navigate('/', { trigger: true });\n  },\n\n  renderCreateView: function(e) {\n    e && e.preventDefault();\n    this.router.navigate('/create', { trigger: true });\n  },\n\n  updateNav: function(routeName) {\n    this.$el.find('.navigation li a')\n      .removeClass('selected')\n      .filter('.' + routeName)\n      .addClass('selected');\n  }\n});\n","Shortly.createLinkView = Backbone.View.extend({\n  className: 'creator',\n\n  template: Templates.create,\n\n  events: {\n    'submit': 'shortenUrl'\n  },\n\n  render: function() {\n    this.$el.html( this.template() );\n    return this;\n  },\n\n  shortenUrl: function(e) {\n    e.preventDefault();\n    var $form = this.$el.find('form .text');\n    var link = new Shortly.Link({ url: $form.val() });\n    link.on('request', this.startSpinner, this);\n    link.on('sync', this.success, this);\n    link.on('error', this.failure, this);\n    link.save({});\n    $form.val('');\n  },\n\n  success: function(link) {\n    this.stopSpinner();\n    var view = new Shortly.LinkView({ model: link });\n    this.$el.find('.message').append(view.render().$el.hide().fadeIn());\n  },\n\n  failure: function(model, res) {\n    this.stopSpinner();\n    this.$el.find('.message')\n      .html('Please enter a valid URL')\n      .addClass('error');\n    return this;\n  },\n\n  startSpinner: function() {\n    this.$el.find('img').show();\n    this.$el.find('form input[type=submit]').attr('disabled', 'true');\n    this.$el.find('.message')\n      .html('')\n      .removeClass('error');\n  },\n\n  stopSpinner: function() {\n    this.$el.find('img').fadeOut('fast');\n    this.$el.find('form input[type=submit]').attr('disabled', null);\n    this.$el.find('.message')\n      .html('')\n      .removeClass('error');\n  }\n});\n","Shortly.Link = Backbone.Model.extend({\n  urlRoot: '/links'\n});\n","Shortly.LinkView = Backbone.View.extend({\n  className: 'link',\n\n  template: Templates.link,\n\n  render: function() {\n    this.$el.html(this.template(this.model.attributes));\n    console.log(this.model);\n    return this;\n  }\n});\n","Shortly.Links = Backbone.Collection.extend({\n  model: Shortly.Link,\n  url: '/links'\n});\n","Shortly.LinksView = Backbone.View.extend({\n  className: 'links',\n\n  initialize: function() {\n    this.collection.on('sync', this.addAll, this);\n    this.collection.fetch();\n  },\n\n  render: function() {\n    this.$el.empty();\n    return this;\n  },\n\n  addAll: function() {\n    this.collection.forEach(this.addOne, this);\n  },\n\n  addOne: function(item) {\n    var view = new Shortly.LinkView({ model: item });\n    this.$el.append(view.render().el);\n  }\n});\n","Shortly.Router = Backbone.Router.extend({\n  initialize: function(options) {\n    this.$el = options.el;\n  },\n\n  routes: {\n    '': 'index',\n    'create': 'create'\n  },\n\n  swapView: function(view) {\n    this.$el.html(view.render().el);\n  },\n\n  index: function() {\n    var links = new Shortly.Links();\n    var linksView = new Shortly.LinksView({ collection: links });\n    this.swapView(linksView);\n  },\n\n  create: function() {\n    this.swapView(new Shortly.createLinkView());\n  }\n});\n"]}